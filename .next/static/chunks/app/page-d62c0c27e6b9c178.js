(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{283:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,O:()=>o});var r=a(5853),s=a(2115);let n=(0,s.createContext)(void 0);function i(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function o(e){let{children:t}=e,[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(!0),c=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();i(t.user)}else i(null)}catch(e){console.error("Auth check failed:",e),i(null)}finally{l(!1)}},d=async(e,t)=>{try{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),r=await a.json();if(a.ok)return i(r.user),{success:!0};return{success:!1,error:r.error}}catch(e){return{success:!1,error:"Network error occurred"}}},m=async(e,t,a)=>{try{let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,displayName:a})}),s=await r.json();if(r.ok)return{success:!0};return{success:!1,error:s.error}}catch(e){return{success:!1,error:"Network error occurred"}}},h=async()=>{try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error("Logout error:",e)}finally{i(null)}},u=async e=>{try{let t=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({displayName:e})}),r=await t.json();if(t.ok)return a&&i({...a,displayName:e}),{success:!0};return{success:!1,error:r.error}}catch(e){return{success:!1,error:"Network error occurred"}}},p=async()=>{await c()};return(0,s.useEffect)(()=>{c()},[]),(0,r.Y)(n.Provider,{value:{user:a,login:d,register:m,logout:h,updateDisplayName:u,loading:o,refreshUser:p},children:t})}},2352:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var r=a(5853),s=a(283),n=a(2115),i=a(4624),o=a(2085),l=a(2596),c=a(9688);function d(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,c.QP)((0,l.$)(t))}let m=(0,o.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"ember-gradient text-primary-foreground hover:opacity-90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=n.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:o=!1,...l}=e,c=o?i.DX:"button";return(0,r.Y)(c,{className:d(m({variant:s,size:n,className:a})),ref:t,...l})});h.displayName="Button";let u=n.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("div",{ref:t,className:d("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});u.displayName="Card";let p=n.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("div",{ref:t,className:d("flex flex-col space-y-1.5 p-6",a),...s})});p.displayName="CardHeader";let f=n.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("h3",{ref:t,className:d("text-2xl font-semibold leading-none tracking-tight",a),...s})});f.displayName="CardTitle";let g=n.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("p",{ref:t,className:d("text-sm text-muted-foreground",a),...s})});g.displayName="CardDescription";let y=n.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("div",{ref:t,className:d("p-6 pt-0",a),...s})});y.displayName="CardContent",n.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.Y)("div",{ref:t,className:d("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter";let N=n.forwardRef((e,t)=>{let{className:a,type:s,...n}=e;return(0,r.Y)("input",{type:s,className:d("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})});N.displayName="Input";let x=e=>{let{children:t,...a}=e;return(0,r.Y)("label",{...a,children:t})};var v=a(8553),w=a(8271),b=a(286),Y=a(3349),F=a(4063),D=a(8046),C=a(7648),k=a(7223),S=a(6603),P=a(620),A=a(7789);function T(e){let{isOpen:t,onAccept:a}=e;return t?(0,r.Y)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,r.FD)(u,{className:"max-w-2xl max-h-[90vh] overflow-y-auto m-4",children:[(0,r.FD)(p,{className:"text-center",children:[(0,r.FD)("div",{className:"flex items-center justify-center mb-4",children:[(0,r.Y)(v.A,{className:"h-8 w-8 text-primary mr-2"}),(0,r.Y)(f,{className:"fire-text text-2xl",children:"Welcome to Ember"})]}),(0,r.Y)(g,{children:"Please review and accept our Terms of Service to continue"})]}),(0,r.FD)(y,{children:[(0,r.FD)("div",{className:"space-y-4 text-sm",children:[(0,r.FD)("div",{children:[(0,r.Y)("h3",{className:"font-semibold text-lg mb-2",children:"Terms of Service"}),(0,r.Y)("p",{className:"text-muted-foreground mb-4",children:"Effective date: Sept 17, 2025"})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Agreement to Terms"}),(0,r.Y)("p",{className:"text-muted-foreground",children:'Welcome to Ember. By accessing or using our chat and rooms platform (the "Service"), you agree to these Terms of Service ("Terms"). If you do not agree, do not use the Service. Our Privacy Policy explains how we collect and use data.'})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Eligibility & Accounts"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"You must be legally able to enter into this agreement and, where applicable, meet the minimum age in your jurisdiction. You are responsible for your account activity and for keeping your credentials secure."})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Community Standards (Zero Tolerance for Racism)"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"Ember is a respectful space. Harassment, hate, and discrimination are prohibited — racism is not tolerated. Content that attacks or dehumanizes people based on race, ethnicity, nationality, religion, gender, sexual orientation, disability, or other protected characteristics may be removed, and accounts may be restricted or terminated."}),(0,r.Y)("p",{className:"text-muted-foreground mt-2",children:"If you encounter abusive behavior, use the report options where available or contact us on Discord."})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Post Names & Comment Content"}),(0,r.FD)("div",{className:"text-muted-foreground space-y-2",children:[(0,r.Y)("p",{children:"Post names and comment content are user-generated. You agree to keep post names appropriate and non-offensive. Profanity, slurs, sexual content targeting minors, or attempts to evade filters (e.g., spacing or symbols) are not allowed. We may apply automated or manual moderation, rename or remove posts, and take enforcement action when needed."}),(0,r.FD)("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[(0,r.Y)("li",{children:"No doxxing, threats, or incitement of violence."}),(0,r.Y)("li",{children:"No illegal content or instructions to facilitate illegal acts."}),(0,r.Y)("li",{children:"No spam, scams, or deceptive practices."}),(0,r.Y)("li",{children:"No explicit sexual content involving minors, ever."})]})]})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Your License to Ember"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"You retain ownership of your content. By posting on Ember, you grant us a worldwide, non-exclusive, royalty-free license to host, store, transmit, display, and reproduce your content solely to operate and improve the Service. You represent you have the rights to post what you share."})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Moderation & Enforcement"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"We may remove content, restrict features, or suspend/terminate accounts to protect users and the platform, including for violations of these Terms or applicable law. We may also take action to prevent spam and abuse."}),(0,r.Y)("p",{className:"text-muted-foreground mt-2",children:"Visible moderation is part of keeping Ember safe. You may see warning labels, removals, or account actions when rules are broken."})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Intellectual Property & DMCA"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"Ember and our logos are our IP. Don't misuse our brand. If you believe content on Ember infringes your copyright, contact us with a detailed notice so we can review and respond appropriately."})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Prohibited Uses"}),(0,r.Y)("div",{className:"text-muted-foreground space-y-1",children:(0,r.FD)("ul",{className:"list-disc list-inside ml-4",children:[(0,r.Y)("li",{children:"Reverse engineering or scraping the Service in violation of our policies."}),(0,r.Y)("li",{children:"Attempting to bypass security, rate limits, or access controls."}),(0,r.Y)("li",{children:"Using Ember to send malware, phishing, or other harmful content."})]})})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Disclaimers & Limitation of Liability"}),(0,r.Y)("p",{className:"text-muted-foreground",children:'The Service is provided "as is" without warranties of any kind. To the fullest extent permitted by law, Ember is not liable for indirect, incidental, special, consequential, or punitive damages, or any loss of data, use, or goodwill.'})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Termination"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"You may stop using Ember at any time. We may suspend or terminate access if you violate these Terms, create risk or legal exposure, or for operational reasons. Certain provisions survive termination, including IP, disclaimers, and limitations of liability."})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Changes to These Terms"}),(0,r.Y)("p",{className:"text-muted-foreground",children:'We may update these Terms to reflect changes to our Service or for legal/regulatory reasons. If changes are material, we\'ll provide notice. The "Effective date" at the top shows when they last changed.'})]}),(0,r.FD)("div",{children:[(0,r.Y)("h4",{className:"font-semibold mb-2",children:"Contact"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"Questions about these Terms? Please reach out on our Discord."})]})]}),(0,r.Y)("div",{className:"flex justify-center mt-8",children:(0,r.Y)(h,{onClick:a,className:"min-w-[200px]",children:"I Accept the Terms of Service"})})]})]})}):null}var j=a(1721),E=a(5268);function _(e){var t;let{displayName:a,username:s,className:i=""}=e,[o,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)({x:0,y:0}),[m,h]=(0,n.useState)(null),[u,p]=(0,n.useState)(!1);if(!a||!s)return(0,r.Y)("span",{className:i,children:a||"Unknown User"});let f=async()=>{if(s&&!m){p(!0);try{let e=await fetch("/api/profile/".concat(s));if(e.ok){let t=await e.json();h(t)}}catch(e){console.error("Failed to fetch user info:",e)}finally{p(!1)}}};return(0,r.FD)(r.FK,{children:[(0,r.Y)("span",{onClick:e=>{e.preventDefault(),e.stopPropagation();let t=e.currentTarget.getBoundingClientRect();d({x:t.left+t.width/2,y:t.top-10}),l(!0),f(),setTimeout(()=>{l(!1)},5e3)},className:"cursor-pointer hover:underline hover:text-primary transition-colors ".concat(i),title:"Click to see user info",children:a}),o&&(0,r.FD)(r.FK,{children:[(0,r.Y)("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),(0,r.FD)("div",{className:"fixed z-50 bg-card border border-border rounded-lg shadow-lg p-3 min-w-[220px]",style:{left:"".concat(c.x,"px"),top:"".concat(c.y,"px"),transform:"translate(-50%, -100%)"},onMouseLeave:()=>{setTimeout(()=>{l(!1)},200)},children:[(0,r.FD)("div",{className:"flex items-start space-x-2",children:[(0,r.Y)(j.A,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),(0,r.FD)("div",{className:"flex-1",children:[(0,r.Y)("p",{className:"text-sm font-medium",children:a}),(0,r.FD)("p",{className:"text-xs text-muted-foreground",children:["@",s]}),u?(0,r.Y)("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading..."}):m?(0,r.FD)("div",{className:"mt-2 space-y-1",children:[(0,r.FD)("div",{className:"flex items-center space-x-1",children:[(0,r.Y)(E.A,{className:"h-3 w-3 text-muted-foreground"}),(0,r.Y)("span",{className:"text-xs text-muted-foreground",children:"Social Credit Score:"}),(0,r.Y)("span",{className:"text-xs font-medium ".concat((t=m.social_credit_score)>=100?"text-green-500":t>=50?"text-blue-500":t>=0?"text-gray-500":t>=-50?"text-orange-500":"text-red-500"),children:m.social_credit_score})]}),(0,r.FD)("p",{className:"text-xs text-muted-foreground",children:["Joined ",new Date(m.created_at).toLocaleDateString("en-US",{month:"short",year:"numeric"})]})]}):null]})]}),(0,r.Y)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-border"}),(0,r.Y)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 translate-y-[-1px] w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-card"})]})]})]})}function L(){let{user:e,login:t,register:a,logout:i,loading:o}=(0,s.A)(),[l,c]=(0,n.useState)("home"),[d,m]=(0,n.useState)(null),[j,E]=(0,n.useState)([]),[L,O]=(0,n.useState)(""),[z,B]=(0,n.useState)([]),[I,U]=(0,n.useState)([]),[M,J]=(0,n.useState)(""),[R,q]=(0,n.useState)([]),[W,H]=(0,n.useState)(null),[V,K]=(0,n.useState)(!1),[Q,Z]=(0,n.useState)("login"),[X,$]=(0,n.useState)({username:"",password:"",displayName:""}),[G,ee]=(0,n.useState)(""),[et,ea]=(0,n.useState)([]),[er,es]=(0,n.useState)([]),[en,ei]=(0,n.useState)({title:"",content:"",categoryId:""}),[eo,el]=(0,n.useState)({displayName:(null==e?void 0:e.displayName)||"",currentPassword:"",newPassword:"",confirmPassword:""}),[ec,ed]=(0,n.useState)(!1),[em,eh]=(0,n.useState)({}),[eu,ep]=(0,n.useState)(!1);(0,n.useEffect)(()=>{ef(),localStorage.getItem("ember-tos-accepted")||ed(!0)},[]),(0,n.useEffect)(()=>{e&&el(t=>({...t,displayName:e.displayName,currentPassword:"",newPassword:"",confirmPassword:""}))},[e]),(0,n.useEffect)(()=>{""===M.trim()?U(z):U(z.filter(e=>e.name.toLowerCase().includes(M.toLowerCase())||e.description.toLowerCase().includes(M.toLowerCase())))},[z,M]);let ef=async()=>{try{let e=await fetch("/api/categories");if(e.ok){let t=await e.json();B(t)}}catch(e){console.error("Failed to fetch categories:",e)}},eg=async e=>{try{let t=await fetch("/api/posts/category/".concat(e));if(t.ok){let e=await t.json();q(e),ej(e)}}catch(e){console.error("Failed to fetch posts:",e)}},ey=async e=>{if(e.preventDefault(),ee(""),"login"===Q){let e=await t(X.username,X.password);e.success?(K(!1),$({username:"",password:"",displayName:""})):ee(e.error||"Login failed")}else{let e=await a(X.username,X.password,X.displayName);e.success?(Z("login"),ee(""),alert("Registration successful! Please log in.")):ee(e.error||"Registration failed")}},eN=e=>{H(e),c("category"),eg(e.id)},ex=async e=>{m(e),c("post"),await ev(e.id)},ev=async e=>{try{let t=await fetch("/api/comments/post/".concat(e));if(t.ok){let e=await t.json();E(e)}}catch(e){console.error("Failed to fetch comments:",e)}},ew=async e=>{if(e.preventDefault(),d&&L.trim())try{let e=await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:L,postId:d.id})});if(e.ok)O(""),ev(d.id);else{let t=await e.json();alert(t.error||"Failed to create comment")}}catch(e){console.error("Failed to create comment:",e)}},eb=async e=>{if(confirm("Are you sure you want to delete this post?"))try{let t=await fetch("/api/posts/".concat(e),{method:"DELETE"});if(t.ok)"post"===l&&c("category"),"category"===l&&W&&eg(W.id),"postManagement"===l&&eD();else{let e=await t.json();alert(e.error||"Failed to delete post")}}catch(e){console.error("Failed to delete post:",e)}},eY=async e=>{if(confirm("Are you sure you want to delete this comment?"))try{let t=await fetch("/api/comments/".concat(e),{method:"DELETE"});if(t.ok)d&&ev(d.id);else{let e=await t.json();alert(e.error||"Failed to delete comment")}}catch(e){console.error("Failed to delete comment:",e)}},eF=async()=>{try{let e=await fetch("/api/admin/users");if(e.ok){let t=await e.json();ea(t)}}catch(e){console.error("Failed to fetch users:",e)}},eD=async()=>{try{let e=await fetch("/api/posts");if(e.ok){let t=await e.json();es(t)}}catch(e){console.error("Failed to fetch all posts:",e)}},eC=async e=>{if(e.preventDefault(),W&&en.title&&en.content)try{let e=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:en.title,content:en.content,categoryId:W.id})});if(e.ok)ei({title:"",content:"",categoryId:""}),c("category"),eg(W.id);else{let t=await e.json();alert(t.error||"Failed to create post")}}catch(e){console.error("Failed to create post:",e)}},ek=async(e,t,a)=>{try{(await fetch("post"===e?"/api/posts/".concat(t,"/vote"):"/api/comments/".concat(t,"/vote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({voteType:a})})).ok&&"category"===l&&W&&eg(W.id)}catch(e){console.error("Failed to vote:",e)}},eS=async e=>{e.preventDefault();try{let e=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({displayName:eo.displayName})});if(e.ok)alert("Display name updated successfully!"),window.location.reload();else{let t=await e.json();alert(t.error||"Failed to update display name")}}catch(e){console.error("Failed to update display name:",e)}},eP=async e=>{if(e.preventDefault(),eo.newPassword!==eo.confirmPassword)return void alert("New passwords do not match");if(eo.newPassword.length<6)return void alert("New password must be at least 6 characters long");try{let e=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:eo.currentPassword,newPassword:eo.newPassword})});if(e.ok)alert("Password changed successfully!"),el(e=>({...e,currentPassword:"",newPassword:"",confirmPassword:""}));else{let t=await e.json();alert(t.error||"Failed to change password")}}catch(e){console.error("Failed to change password:",e),alert("Failed to change password")}},eA=async()=>{if(confirm("Are you sure you want to delete ALL posts and comments? This action cannot be undone!"))try{let e=await fetch("/api/admin/delete-all",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"all"})});if(e.ok)alert("All posts and comments deleted successfully"),"postManagement"===l&&eD();else{let t=await e.json();alert(t.error||"Failed to delete posts and comments")}}catch(e){console.error("Failed to delete all posts:",e)}},eT=async e=>{if(confirm("Are you sure you want to delete this user account? This action cannot be undone!"))try{let t=await fetch("/api/admin/users/".concat(e,"/delete"),{method:"POST"});if(t.ok)alert("User account deleted successfully"),eF();else{let e=await t.json();alert(e.error||"Failed to delete user account")}}catch(e){console.error("Failed to delete user account:",e)}},ej=async e=>{let t={};for(let a of e)try{let e=await fetch("/api/comments/post/".concat(a.id));if(e.ok){let r=await e.json();t[a.id]=r.length}}catch(e){console.error("Failed to fetch comment count for post",a.id,e)}eh(t)},eE=e=>{let t=new Date(e);return{date:t.toLocaleDateString(),time:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}};return o?(0,r.Y)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.FD)("div",{className:"text-center",children:[(0,r.Y)(v.A,{className:"h-12 w-12 text-primary mx-auto mb-4 animate-pulse"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"Loading Ember..."})]})}):e||V?!e&&V?(0,r.Y)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,r.FD)(u,{className:"w-full max-w-md",children:[(0,r.FD)(p,{className:"text-center",children:[(0,r.FD)("div",{className:"flex items-center justify-center mb-4",children:[(0,r.Y)(v.A,{className:"h-8 w-8 text-primary mr-2"}),(0,r.Y)(f,{className:"fire-text",children:"Ember"})]}),(0,r.Y)(g,{children:"login"===Q?"Welcome back to the fire":"Join the blazing community"})]}),(0,r.Y)(y,{children:(0,r.FD)("form",{onSubmit:ey,className:"space-y-4",children:[(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"username",children:"Username"}),(0,r.Y)(N,{id:"username",value:X.username,onChange:e=>$(t=>({...t,username:e.target.value})),required:!0})]}),(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"password",children:"Password"}),(0,r.Y)(N,{id:"password",type:"password",value:X.password,onChange:e=>$(t=>({...t,password:e.target.value})),required:!0})]}),"register"===Q&&(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"displayName",children:"Display Name"}),(0,r.Y)(N,{id:"displayName",value:X.displayName,onChange:e=>$(t=>({...t,displayName:e.target.value})),required:!0})]}),G&&(0,r.Y)("p",{className:"text-sm text-red-500",children:G}),(0,r.Y)(h,{type:"submit",className:"w-full",children:"login"===Q?"Enter the Fire":"Ignite Your Account"}),(0,r.Y)(h,{type:"button",variant:"ghost",className:"w-full",onClick:()=>{Z("login"===Q?"register":"login"),ee("")},children:"login"===Q?"Need an account? Register":"Have an account? Login"}),(0,r.Y)(h,{type:"button",variant:"ghost",className:"w-full",onClick:()=>K(!1),children:"Back"})]})})]})}):(0,r.FD)("div",{className:"min-h-screen",children:[(0,r.Y)("header",{className:"border-b border-border bg-card/50 backdrop-blur",children:(0,r.Y)("div",{className:"container mx-auto px-4 py-4",children:(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)("div",{className:"flex items-center cursor-pointer",onClick:()=>c("home"),children:[(0,r.Y)(v.A,{className:"h-8 w-8 text-primary mr-2"}),(0,r.Y)("h1",{className:"text-2xl font-bold fire-text",children:"Ember"})]}),(0,r.FD)("div",{className:"flex items-center space-x-4",children:[(0,r.FD)("span",{className:"text-sm text-muted-foreground",children:["Welcome, ",null==e?void 0:e.displayName]}),(0,r.FD)(h,{variant:"outline",size:"sm",onClick:()=>c("settings"),children:[(0,r.Y)(w.A,{className:"h-4 w-4 mr-2"}),"Settings"]}),(null==e?void 0:e.isAdmin)&&(0,r.FD)(h,{variant:"outline",size:"sm",onClick:()=>c("admin"),children:[(0,r.Y)(b.A,{className:"h-4 w-4 mr-2"}),"Admin"]}),(0,r.FD)(h,{variant:"outline",size:"sm",onClick:i,children:[(0,r.Y)(Y.A,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})})}),(0,r.FD)("main",{className:"container mx-auto px-4 py-8",children:["home"===l&&(0,r.FD)("div",{children:[(0,r.FD)("div",{className:"text-center mb-8",children:[(0,r.Y)("h2",{className:"text-4xl font-bold mb-4",children:"Forum Categories"}),(0,r.Y)("p",{className:"text-muted-foreground mb-6",children:"Choose a category to start the discussion"}),(0,r.Y)("div",{className:"max-w-md mx-auto mb-6",children:(0,r.Y)(N,{type:"text",placeholder:"Search categories...",value:M,onChange:e=>J(e.target.value),className:"w-full"})})]}),(0,r.Y)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:I.map(e=>(0,r.Y)(u,{className:"category-card cursor-pointer hover-flicker",onClick:()=>eN(e),children:(0,r.FD)(p,{children:[(0,r.FD)(f,{className:"flex items-center",children:[(0,r.Y)(F.A,{className:"h-5 w-5 mr-2 text-primary"}),e.name]}),(0,r.Y)(g,{children:e.description})]})},e.id))}),(0===I.length||""===M)&&(0,r.FD)("div",{className:"text-center",children:[(0,r.FD)(h,{variant:"outline",onClick:()=>ep(!0),className:"mb-4",children:[(0,r.Y)(D.A,{className:"h-4 w-4 mr-2"}),"Suggest New Category"]}),0===I.length&&""!==M&&(0,r.FD)("p",{className:"text-muted-foreground mt-4",children:['No categories found matching "',M,'". Consider suggesting a new category!']})]})]}),"category"===l&&W&&(0,r.FD)("div",{children:[(0,r.FD)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.FD)("div",{children:[(0,r.Y)(h,{variant:"ghost",onClick:()=>c("home"),className:"mb-4",children:"← Back to Categories"}),(0,r.Y)("h2",{className:"text-4xl font-bold",children:W.name}),(0,r.Y)("p",{className:"text-muted-foreground",children:W.description})]}),(0,r.FD)(h,{onClick:()=>c("newPost"),children:[(0,r.Y)(D.A,{className:"h-4 w-4 mr-2"}),"New Post"]})]}),(0,r.Y)("div",{className:"space-y-4",children:0===R.length?(0,r.Y)(u,{className:"post-card",children:(0,r.FD)(y,{className:"text-center py-12",children:[(0,r.Y)(F.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"No posts yet. Be the first to start the discussion!"})]})}):R.map(t=>(0,r.Y)(u,{className:"post-card",children:(0,r.FD)(y,{className:"flex gap-4 p-6",children:[(0,r.FD)("div",{className:"flex flex-col items-center space-y-1 min-w-[60px]",children:[(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),ek("post",t.id,1)},className:"h-8 w-8 p-0 hover:bg-green-500/20",children:"▲"}),(0,r.Y)("span",{className:"text-sm font-semibold text-center",children:t.score||0}),(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),ek("post",t.id,-1)},className:"h-8 w-8 p-0 hover:bg-red-500/20",children:"▼"})]}),(0,r.FD)("div",{className:"flex-1 cursor-pointer hover:bg-accent/20 rounded p-2 -m-2 transition-colors",onClick:()=>ex(t),children:[(0,r.Y)("h3",{className:"text-xl font-semibold mb-2",children:t.title}),(0,r.Y)("p",{className:"text-muted-foreground line-clamp-3 mb-3",children:t.content}),(0,r.FD)("div",{className:"flex items-center justify-between",children:[(0,r.FD)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,r.FD)("span",{children:["By ",(0,r.Y)(_,{displayName:t.display_name,username:t.username})]}),(0,r.Y)("span",{children:"•"}),(0,r.Y)("span",{children:eE(t.created_at).date}),(0,r.Y)("span",{children:"•"}),(0,r.FD)("div",{className:"flex items-center space-x-1",children:[(0,r.Y)(C.A,{className:"h-3 w-3"}),(0,r.Y)("span",{children:eE(t.created_at).time})]}),(0,r.Y)("span",{children:"•"}),(0,r.FD)("div",{className:"flex items-center space-x-1",children:[(0,r.Y)(F.A,{className:"h-3 w-3"}),(0,r.FD)("span",{children:[em[t.id]||0," comments"]})]})]}),((null==e?void 0:e.isAdmin)||(null==e?void 0:e.id)===t.user_id)&&(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),eb(t.id)},className:"text-red-500 hover:text-red-700 hover:bg-red-100",children:(0,r.Y)(k.A,{className:"h-4 w-4"})})]})]})]})},t.id))})]}),"admin"===l&&(null==e?void 0:e.isAdmin)&&(0,r.FD)("div",{children:[(0,r.Y)("h2",{className:"text-4xl font-bold mb-8",children:"Admin Dashboard"}),(0,r.FD)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,r.Y)(u,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>{c("userManagement"),eF()},children:(0,r.FD)(p,{children:[(0,r.FD)(f,{className:"flex items-center",children:[(0,r.Y)(b.A,{className:"h-5 w-5 mr-2 text-primary"}),"User Management"]}),(0,r.Y)(g,{children:"View and manage all users"})]})}),(0,r.Y)(u,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>{c("postManagement"),eD()},children:(0,r.FD)(p,{children:[(0,r.FD)(f,{className:"flex items-center",children:[(0,r.Y)(F.A,{className:"h-5 w-5 mr-2 text-primary"}),"Post Management"]}),(0,r.Y)(g,{children:"View and moderate all posts"})]})})]})]}),"userManagement"===l&&(null==e?void 0:e.isAdmin)&&(0,r.FD)("div",{children:[(0,r.Y)(h,{variant:"ghost",onClick:()=>c("admin"),className:"mb-4",children:"← Back to Admin Dashboard"}),(0,r.FD)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.Y)("h2",{className:"text-4xl font-bold",children:"User Management"}),(0,r.FD)(h,{variant:"destructive",onClick:eA,children:[(0,r.Y)(k.A,{className:"h-4 w-4 mr-2"}),"Delete All Posts & Comments"]})]}),(0,r.Y)("div",{className:"space-y-4",children:et.map(e=>(0,r.Y)(u,{children:(0,r.FD)(y,{className:"flex items-center justify-between p-6",children:[(0,r.FD)("div",{children:[(0,r.Y)("h3",{className:"font-semibold",children:(0,r.Y)(_,{displayName:e.display_name,username:e.username})}),(0,r.FD)("p",{className:"text-sm text-muted-foreground",children:["@",e.username]}),(0,r.FD)("p",{className:"text-sm text-muted-foreground",children:["Joined: ",new Date(e.created_at).toLocaleDateString()]}),e.ip_address&&(0,r.FD)("p",{className:"text-sm text-muted-foreground",children:["IP: ",e.ip_address]}),e.is_banned&&(0,r.Y)("span",{className:"text-red-500 text-sm",children:"BANNED"}),e.is_muted&&(0,r.Y)("span",{className:"text-orange-500 text-sm",children:"MUTED"})]}),(0,r.FD)("div",{className:"flex space-x-2",children:[(0,r.FD)(h,{variant:"outline",size:"sm",onClick:async()=>{let t=e.is_banned?"unban":"ban";(await fetch("/api/admin/users/".concat(e.id,"/ban"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t})})).ok&&eF()},children:[(0,r.Y)(S.A,{className:"h-4 w-4 mr-2"}),e.is_banned?"Unban":"Ban"]}),(0,r.FD)(h,{variant:"outline",size:"sm",onClick:async()=>{let t=e.is_muted?"unmute":"mute";(await fetch("/api/admin/users/".concat(e.id,"/mute"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t})})).ok&&eF()},children:[e.is_muted?(0,r.Y)(P.A,{className:"h-4 w-4 mr-2"}):(0,r.Y)(A.A,{className:"h-4 w-4 mr-2"}),e.is_muted?"Unmute":"Mute"]}),(0,r.FD)(h,{variant:"destructive",size:"sm",onClick:()=>eT(e.id),children:[(0,r.Y)(k.A,{className:"h-4 w-4 mr-2"}),"Delete Account"]})]})]})},e.id))})]}),"postManagement"===l&&(null==e?void 0:e.isAdmin)&&(0,r.FD)("div",{children:[(0,r.Y)(h,{variant:"ghost",onClick:()=>c("admin"),className:"mb-4",children:"← Back to Admin Dashboard"}),(0,r.Y)("h2",{className:"text-4xl font-bold mb-8",children:"Post Management"}),(0,r.Y)("div",{className:"space-y-4",children:er.map(e=>(0,r.Y)(u,{children:(0,r.Y)(y,{className:"p-6",children:(0,r.FD)("div",{className:"flex justify-between items-start",children:[(0,r.FD)("div",{className:"flex-1",children:[(0,r.Y)("h3",{className:"font-semibold text-lg",children:e.title}),(0,r.FD)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground mb-2",children:[(0,r.FD)("span",{children:["By ",(0,r.Y)(_,{displayName:e.display_name,username:e.username})," in ",e.category_name]}),(0,r.Y)("span",{children:"•"}),(0,r.Y)("span",{children:new Date(e.created_at).toLocaleDateString()}),(0,r.Y)("span",{children:"•"}),(0,r.FD)("div",{className:"flex items-center space-x-1",children:[(0,r.Y)(C.A,{className:"h-3 w-3"}),(0,r.Y)("span",{children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),(0,r.Y)("p",{className:"text-muted-foreground line-clamp-2",children:e.content}),(0,r.FD)("p",{className:"text-sm text-muted-foreground mt-2",children:["Score: ",e.score||0," (",e.upvotes||0," ↑ ",e.downvotes||0," ↓)"]})]}),(0,r.FD)(h,{variant:"destructive",size:"sm",onClick:async()=>{confirm("Are you sure you want to delete this post?")&&(await fetch("/api/posts/".concat(e.id),{method:"DELETE"})).ok&&eD()},children:[(0,r.Y)(k.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})})},e.id))})]}),"settings"===l&&(0,r.FD)("div",{children:[(0,r.Y)("h2",{className:"text-4xl font-bold mb-8",children:"Settings"}),(0,r.FD)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl",children:[(0,r.FD)(u,{children:[(0,r.FD)(p,{children:[(0,r.Y)(f,{children:"Profile Settings"}),(0,r.Y)(g,{children:"Update your display name"})]}),(0,r.Y)(y,{children:(0,r.FD)("form",{onSubmit:eS,className:"space-y-4",children:[(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"displayName",children:"Display Name"}),(0,r.Y)(N,{id:"displayName",value:eo.displayName,onChange:e=>el(t=>({...t,displayName:e.target.value})),required:!0})]}),(0,r.Y)(h,{type:"submit",className:"w-full",children:"Update Display Name"})]})})]}),(0,r.FD)(u,{children:[(0,r.FD)(p,{children:[(0,r.Y)(f,{children:"Change Password"}),(0,r.Y)(g,{children:"Update your account password"})]}),(0,r.Y)(y,{children:(0,r.FD)("form",{onSubmit:eP,className:"space-y-4",children:[(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"currentPassword",children:"Current Password"}),(0,r.Y)(N,{id:"currentPassword",type:"password",value:eo.currentPassword,onChange:e=>el(t=>({...t,currentPassword:e.target.value})),required:!0})]}),(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"newPassword",children:"New Password"}),(0,r.Y)(N,{id:"newPassword",type:"password",value:eo.newPassword,onChange:e=>el(t=>({...t,newPassword:e.target.value})),required:!0,minLength:6})]}),(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,r.Y)(N,{id:"confirmPassword",type:"password",value:eo.confirmPassword,onChange:e=>el(t=>({...t,confirmPassword:e.target.value})),required:!0,minLength:6})]}),(0,r.Y)(h,{type:"submit",className:"w-full",children:"Change Password"})]})})]})]})]}),"post"===l&&d&&(0,r.FD)("div",{children:[(0,r.FD)(h,{variant:"ghost",onClick:()=>c("category"),className:"mb-4",children:["← Back to ",null==W?void 0:W.name]}),(0,r.Y)(u,{className:"post-card mb-6",children:(0,r.FD)(y,{className:"flex gap-4 p-6",children:[(0,r.FD)("div",{className:"flex flex-col items-center space-y-1 min-w-[60px]",children:[(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:()=>ek("post",d.id,1),className:"h-8 w-8 p-0 hover:bg-green-500/20",children:"▲"}),(0,r.Y)("span",{className:"text-sm font-semibold text-center",children:d.score||0}),(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:()=>ek("post",d.id,-1),className:"h-8 w-8 p-0 hover:bg-red-500/20",children:"▼"})]}),(0,r.Y)("div",{className:"flex-1",children:(0,r.FD)("div",{className:"flex items-start justify-between",children:[(0,r.FD)("div",{className:"flex-1",children:[(0,r.Y)("h1",{className:"text-3xl font-bold mb-4",children:d.title}),(0,r.Y)("p",{className:"text-muted-foreground mb-4 whitespace-pre-wrap",children:d.content}),(0,r.FD)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,r.FD)("span",{children:["By ",(0,r.Y)(_,{displayName:d.display_name,username:d.username})]}),(0,r.Y)("span",{children:"•"}),(0,r.Y)("span",{children:eE(d.created_at).date}),(0,r.Y)("span",{children:"•"}),(0,r.FD)("div",{className:"flex items-center space-x-1",children:[(0,r.Y)(C.A,{className:"h-3 w-3"}),(0,r.Y)("span",{children:eE(d.created_at).time})]})]})]}),((null==e?void 0:e.isAdmin)||(null==e?void 0:e.id)===d.user_id)&&(0,r.FD)(h,{variant:"ghost",size:"sm",onClick:()=>eb(d.id),className:"text-red-500 hover:text-red-700 hover:bg-red-100",children:[(0,r.Y)(k.A,{className:"h-4 w-4 mr-2"}),"Delete Post"]})]})})]})}),e&&!e.isMuted&&(0,r.FD)(u,{className:"mb-6",children:[(0,r.Y)(p,{children:(0,r.Y)(f,{children:"Add a Comment"})}),(0,r.Y)(y,{children:(0,r.FD)("form",{onSubmit:ew,className:"space-y-4",children:[(0,r.Y)("textarea",{className:"w-full h-24 p-3 border border-border rounded-md bg-background",value:L,onChange:e=>O(e.target.value),placeholder:"Share your thoughts...",required:!0}),(0,r.Y)(h,{type:"submit",children:"Post Comment"})]})})]}),(0,r.FD)("div",{className:"space-y-4",children:[(0,r.FD)("h2",{className:"text-2xl font-bold",children:["Comments (",j.length,")"]}),0===j.length?(0,r.Y)(u,{children:(0,r.FD)(y,{className:"text-center py-8",children:[(0,r.Y)(F.A,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,r.Y)("p",{className:"text-muted-foreground",children:"No comments yet. Be the first to comment!"})]})}):j.map(t=>(0,r.Y)(u,{className:"comment-card",children:(0,r.FD)(y,{className:"flex gap-4 p-4",children:[(0,r.FD)("div",{className:"flex flex-col items-center space-y-1 min-w-[50px]",children:[(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:()=>ek("comment",t.id,1),className:"h-6 w-6 p-0 hover:bg-green-500/20 text-xs",children:"▲"}),(0,r.Y)("span",{className:"text-xs font-semibold text-center",children:t.score||0}),(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:()=>ek("comment",t.id,-1),className:"h-6 w-6 p-0 hover:bg-red-500/20 text-xs",children:"▼"})]}),(0,r.Y)("div",{className:"flex-1",children:(0,r.FD)("div",{className:"flex items-start justify-between",children:[(0,r.FD)("div",{className:"flex-1",children:[(0,r.Y)("p",{className:"mb-2 whitespace-pre-wrap",children:t.content}),(0,r.FD)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,r.FD)("span",{children:["By ",(0,r.Y)(_,{displayName:t.display_name,username:t.username})]}),(0,r.Y)("span",{children:"•"}),(0,r.Y)("span",{children:eE(t.created_at).date}),(0,r.Y)("span",{children:"•"}),(0,r.FD)("div",{className:"flex items-center space-x-1",children:[(0,r.Y)(C.A,{className:"h-3 w-3"}),(0,r.Y)("span",{children:eE(t.created_at).time})]})]})]}),((null==e?void 0:e.isAdmin)||(null==e?void 0:e.id)===t.user_id)&&(0,r.Y)(h,{variant:"ghost",size:"sm",onClick:()=>eY(t.id),className:"text-red-500 hover:text-red-700 hover:bg-red-100",children:(0,r.Y)(k.A,{className:"h-4 w-4"})})]})})]})},t.id))]})]}),"newPost"===l&&W&&(0,r.FD)("div",{children:[(0,r.FD)(h,{variant:"ghost",onClick:()=>c("category"),className:"mb-4",children:["← Back to ",W.name]}),(0,r.FD)("h2",{className:"text-4xl font-bold mb-8",children:["Create New Post in ",W.name]}),(0,r.FD)(u,{className:"max-w-2xl",children:[(0,r.FD)(p,{children:[(0,r.Y)(f,{children:"New Post"}),(0,r.Y)(g,{children:"Share your thoughts with the community"})]}),(0,r.Y)(y,{children:(0,r.FD)("form",{onSubmit:eC,className:"space-y-4",children:[(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"title",children:"Post Title"}),(0,r.Y)(N,{id:"title",value:en.title,onChange:e=>ei(t=>({...t,title:e.target.value})),placeholder:"Enter a compelling title...",required:!0})]}),(0,r.FD)("div",{children:[(0,r.Y)(x,{htmlFor:"content",children:"Content"}),(0,r.Y)("textarea",{id:"content",className:"w-full h-32 p-3 border border-border rounded-md bg-background",value:en.content,onChange:e=>ei(t=>({...t,content:e.target.value})),placeholder:"Share your thoughts...",required:!0})]}),(0,r.FD)("div",{className:"flex space-x-4",children:[(0,r.Y)(h,{type:"submit",className:"flex-1",children:"Create Post"}),(0,r.Y)(h,{type:"button",variant:"outline",onClick:()=>c("category"),children:"Cancel"})]})]})})]})]})]}),eu&&(0,r.Y)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.FD)("div",{className:"bg-card border border-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[(0,r.Y)("h3",{className:"text-xl font-bold mb-4",children:"Suggest a New Category"}),(0,r.Y)("p",{className:"text-muted-foreground mb-4",children:"Help us improve the forum by suggesting a new category! Fill out this form and our team will review your suggestion."}),(0,r.Y)("iframe",{src:"https://forms.cloud.microsoft/r/Zpq54BvbRN",width:"100%",height:"500",frameBorder:"0",marginHeight:0,marginWidth:0,className:"rounded border",title:"Suggest New Category Form",children:"Loading form..."}),(0,r.Y)("div",{className:"flex justify-end mt-4",children:(0,r.Y)(h,{variant:"outline",onClick:()=>ep(!1),children:"Close"})})]})}),(0,r.Y)(T,{isOpen:ec,onAccept:()=>{localStorage.setItem("ember-tos-accepted","true"),ed(!1)}})]}):(0,r.Y)("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:(0,r.FD)("div",{className:"text-center mb-8",children:[(0,r.FD)("div",{className:"flex items-center justify-center mb-4",children:[(0,r.Y)(v.A,{className:"h-16 w-16 text-primary mr-4"}),(0,r.Y)("h1",{className:"text-6xl font-bold fire-text",children:"Ember"})]}),(0,r.Y)("p",{className:"text-xl text-muted-foreground mb-8",children:"A blazing hot community forum for passionate discussions"}),(0,r.Y)(h,{onClick:()=>K(!0),className:"mr-4",children:"Join the Fire"})]})})}},2391:(e,t,a)=>{Promise.resolve().then(a.bind(a,2352))}},e=>{var t=t=>e(e.s=t);e.O(0,[853,264,441,684,358],()=>t(2391)),_N_E=e.O()}]);